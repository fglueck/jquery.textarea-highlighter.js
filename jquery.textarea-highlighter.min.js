/**
 * jquery.textareaHighlighter.js 0.2.1
 * jQuery plugin for highlighting text in textarea.
 *
 * alexandre.kirillov@gmail.com
 * MIT license. http://opensource.org/licenses/MIT
 */
!function(a,b,c){"use strict";function g(b,c){this.element=b,this.$element=a(this.element),this.settings=a.extend({},f,this.$element.data(),c),this._defaults=f,this._name=e,this.style={paddingTop:parseInt(this.$element.css("padding-top"),10),paddingRight:parseInt(this.$element.css("padding-right"),10),paddingBottom:parseInt(this.$element.css("padding-bottom"),10),paddingLeft:parseInt(this.$element.css("padding-left"),10)},i.firefox&&(this.style.paddingRight+=1,this.style.paddingLeft+=1),i.iphone&&(this.style.paddingRight+=3,this.style.paddingLeft+=3),this.init()}var e="textareaHighlighter",f={matches:[],maxlength:-1,maxlengthWarning:"",maxlengthElement:null,debug:!1};g.prototype={init:function(){var d=this.$element,e=this.style,f=this.settings,g=a(c.createElement("div")).addClass("textarea-wrap"),i=a(c.createElement("div"));g.css({position:"relative","word-wrap":"break-word","word-break":"break-all",margin:0}),i.addClass("background-div").addClass(d.attr("class")).css({height:"100%",color:f.debug?"#f00":"transparent","background-color":f.debug?"#fee":e.backgroundColor,"padding-top":e.paddingTop,"padding-right":e.paddingRight,"padding-bottom":e.paddingBottom,"padding-left":e.paddingLeft,position:"absolute",overflow:"auto"}),d.data("changeTimerId",-1).css({color:f.debug?"rgba(0,0,0,0.5)":"inherit",position:"relative",background:"transparent"}).on("scroll",function(){i.scrollTop(d.scrollTop())}).on("change keydown keyup paste",function(b){if(!/(37|38|39|40)/.test(b.keyCode)){-1!==d.data("changeTimerId")&&(clearTimeout(d.data("changeTimerId")),d.data("changeTimerId",-1));var e=setTimeout(function(){var j,k,o,p,q,r,s,b=a(c.createElement("div")).text(d.val()).html(),l=[],m="",n="";for(0<f.maxlength?(f.maxlength<d.val().length&&(j=d.val().slice(f.maxlength,f.maxlength+d.val().length-1),n='<span class="'+f.maxlengthWarning+'">'+j+"</span>"),null!==f.maxlengthElement&&(s=f.maxlength-d.val().length,0>s?f.maxlengthElement.hasClass(f.maxlengthWarning)||f.maxlengthElement.addClass(f.maxlengthWarning):f.maxlengthElement.hasClass(f.maxlengthWarning)&&f.maxlengthElement.removeClass(f.maxlengthWarning),f.maxlengthElement.text(s)),m=d.val().slice(0,f.maxlength)):m=b,o=0,p=f.matches.length;p>o;o++)for(q=0,r=f.matches[o].words.length;r>q;q++)j=f.matches[o].words[q],-1!==m.indexOf(j)&&(l.push(j),k='<span class="'+f.matches[o].className+'">'+j+"</span>",m=m.replace(new RegExp(h(j),"g"),k));i.html(m+n),d.trigger("textarea.highlighter.update",{textList:l})},30);d.data("changeTimerId",e)}}),d.wrap(g).before(i),d.trigger("keydown")}},a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new g(this,b))})};var h=function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},i=function(){var a=navigator.userAgent,b=/(msie|trident)/i.test(a),c=/chrome/i.test(a),d=/firefox/i.test(a),e=/safari/i.test(a)&&!c,f=/iphone/i.test(a);return b?{msie:!0}:c?{chrome:!0}:d?{firefox:!0}:f?{iphone:!0}:e?{safari:!0}:{msie:!1,chrome:!1,firefox:!1,safari:!1,iphone:!1}}()}(jQuery,window,document);