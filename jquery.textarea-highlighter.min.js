/**
 * jquery.textareaHighlighter.js 0.2.2
 * jQuery plugin for highlighting text in textarea.
 *
 * alexandre.kirillov@gmail.com
 * MIT license. http://opensource.org/licenses/MIT
 */
!function(a,b,c){"use strict";function g(b,d){this.element=b,this.$element=a(this.element),this.settings=a.extend({},f,this.$element.data(),d),this._defaults=f,this._name=e,this.$element.data(e)||(this.$element.data(e,!0),this.style={},this.$wrapDiv=a(c.createElement("div")).addClass("textarea-highlighter-wrap"),this.$backgroundDiv=a(c.createElement("div")),this.init())}var e="textareaHighlighter",f={matches:[],maxlength:-1,maxlengthWarning:"",maxlengthElement:null,isCustomeCss:!1,debug:!1};g.prototype={init:function(){var a=this,b=this.$element,e=(this.style,this.settings,this.$wrapDiv),f=this.$backgroundDiv;a.updateStyle(),b.data("highlighterTimerId",-1).on("scroll.textarea.highlighter",function(){f.scrollTop(b.scrollTop())}).on("textarea.highlighter.update",function(){a.updateStyle()}),i.msie?b.on("input.textarea.highlighter keyup.textarea.highlighter",function(b){a.change(b)}):b.on("input.textarea.highlighter",function(b){a.change(b)}),b.wrap(e).before(f),a.change({})},updateStyle:function(){var b=this.$element,c=this.settings,d=this.style;this.style={paddingTop:parseInt(b.css("padding-top"),10),paddingRight:parseInt(b.css("padding-right"),10),paddingBottom:parseInt(b.css("padding-bottom"),10),paddingLeft:parseInt(b.css("padding-left"),10)},i.firefox&&(d.paddingRight+=1,d.paddingLeft+=1),i.iphone&&(d.paddingRight+=3,d.paddingLeft+=3),this.$wrapDiv.css({position:"relative","word-wrap":"break-word","word-break":"break-all",margin:0}),this.$backgroundDiv.addClass("background-div").addClass(b.attr("class")).css({height:"100%",color:c.debug?"#f00":"transparent",position:"absolute",overflow:"auto",margin:"0"}),c.isCustomeCss||this.$backgroundDiv.css({"padding-top":d.paddingTop,"padding-right":d.paddingRight,"padding-bottom":d.paddingBottom,"padding-left":d.paddingLeft,"box-sizing":"border-box","border-color":"transparent"}),b.css({color:c.debug?"rgba(0,0,0,0.5)":"inherit",position:"relative",background:"transparent"})},change:function(b){var d=this;if(/(37|38|39|40)/.test(b.keyCode))return!0;-1!==d.$element.data("highlighterTimerId")&&(clearTimeout(d.$element.data("highlighterTimerId")),d.$element.data("highlighterTimerId",-1));var e=setTimeout(function(){var g,i,m,n,o,p,q,b=a(c.createElement("div")).text(d.$element.val()).html(),j=[],k="",l="";for(0<d.settings.maxlength?(d.settings.maxlength<d.$element.val().length&&(g=d.$element.val().slice(d.settings.maxlength,d.settings.maxlength+d.$element.val().length-1),l='<span class="'+d.settings.maxlengthWarning+'">'+g+"</span>"),null!==d.settings.maxlengthElement&&(q=d.settings.maxlength-d.$element.val().length,0>q?d.settings.maxlengthElement.hasClass(d.settings.maxlengthWarning)||d.settings.maxlengthElement.addClass(d.settings.maxlengthWarning):d.settings.maxlengthElement.hasClass(d.settings.maxlengthWarning)&&d.settings.maxlengthElement.removeClass(d.settings.maxlengthWarning),d.settings.maxlengthElement.text(q)),k=d.$element.val().slice(0,d.settings.maxlength)):k=b,m=0,n=d.settings.matches.length;n>m;m++)for(o=0,p=d.settings.matches[m].words.length;p>o;o++)g=d.settings.matches[m].words[o],-1!==k.indexOf(g)&&(j.push(g),i='<span class="'+d.settings.matches[m].className+'">'+g+"</span>",k=k.replace(new RegExp(h(g),"g"),i));d.$backgroundDiv.html(k+l),d.$element.trigger("textarea.highlighter.update",{textList:j})},30);d.$element.data("highlighterTimerId",e)}},a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new g(this,b))})};var h=function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},i=function(){var a=navigator.userAgent,b=/(msie|trident)/i.test(a),c=/chrome/i.test(a),d=/firefox/i.test(a),e=/safari/i.test(a)&&!c,f=/iphone/i.test(a);return b?{msie:!0}:c?{chrome:!0}:d?{firefox:!0}:f?{iphone:!0}:e?{safari:!0}:{msie:!1,chrome:!1,firefox:!1,safari:!1,iphone:!1}}()}(jQuery,window,document);