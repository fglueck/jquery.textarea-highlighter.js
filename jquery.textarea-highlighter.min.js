/**
 * jquery.textareaHighlighter.js 0.2.7
 * jQuery plugin for highlighting text in textarea.
 *
 * alexandre.kirillov@gmail.com
 * MIT license. http://opensource.org/licenses/MIT
 */
!function(a,b,c){"use strict";function g(b,d){this.isInited=!1,this.element=b,this.$element=a(this.element),this.settings=a.extend({},f,this.$element.data(),d),this._defaults=f,this._name=e,this.style={},this.$wrapDiv=a(c.createElement("div")).addClass("textarea-highlighter-wrap"),this.$backgroundDiv=a(c.createElement("div")),this.init()}var e="textareaHighlighter",f={matches:[],maxlength:-1,maxlengthWarning:"",maxlengthElement:null,isCustomeCss:!1,debug:!1,typingDelay:30};g.prototype={init:function(){var a=this,b=this.$element,e=(this.style,this.settings,this.$wrapDiv),f=this.$backgroundDiv;a.updateStyle(),b.data("highlighterTimerId",-1).on("scroll.textarea.highlighter",function(){f.scrollTop(b.scrollTop())}).on("textarea.highlighter.destroy",function(){a.destroy()}).on("textarea.highlighter.updateStyle",function(){a.updateStyle()}).on("textarea.highlighter.change",function(){a.change({})}).on("textarea.highlighter.debug.on",function(){a.debugModeOn()}).on("textarea.highlighter.debug.off",function(){a.debugModeOff()}),i.msie?b.on("input.textarea.highlighter keyup.textarea.highlighter",function(b){a.change(b)}):b.on("input.textarea.highlighter",function(b){a.change(b)}),b.wrap(e).before(f),a.change({})},updateStyle:function(){var b=this.$element,c=this.settings,d=this.style;this.style={paddingTop:parseInt(b.css("padding-top"),10),paddingRight:parseInt(b.css("padding-right"),10),paddingBottom:parseInt(b.css("padding-bottom"),10),paddingLeft:parseInt(b.css("padding-left"),10)},i.firefox&&(d.paddingRight+=1,d.paddingLeft+=1),i.iphone&&(d.paddingRight+=3,d.paddingLeft+=3),this.$wrapDiv.css({position:"relative",margin:0}),this.$backgroundDiv.addClass("background-div").addClass(b.attr("class")).css({height:"100%",color:c.debug?"#f00":"transparent",position:"absolute",margin:"0"}),c.isCustomeCss||this.$backgroundDiv.css({"padding-top":d.paddingTop,"padding-right":d.paddingRight,"padding-bottom":d.paddingBottom,"padding-left":d.paddingLeft,"box-sizing":"border-box","border-color":"transparent"}),b.css({color:c.debug?"rgba(0,0,0,0.5)":"inherit",position:"relative",background:"transparent"})},change:function(a){var b=this,c=b.settings;if(/(37|38|39|40)/.test(a.keyCode))return!0;-1!==b.$element.data("highlighterTimerId")&&(clearTimeout(b.$element.data("highlighterTimerId")),b.$element.data("highlighterTimerId",-1));var d=setTimeout(function(){var a,j,k,l,m,e=[],f=[],g=0,i=null,n=b.checkMaxLength(),o=n.overMaxText,p=n.notOverMaxText;for(j=0,k=c.matches.length;k>j;j++)for(g=0,c.matches[j].hasOwnProperty("maxMatchCnt")&&(g=c.matches[j].maxMatchCnt),f=c.matches[j].match instanceof RegExp?p.match(c.matches[j].match)||[]:c.matches[j].match,l=0,m=f.length;m>l;l++){a=f[l],i=null;var q="";0!==g&&(i=p.match(new RegExp(h(a),"g"))),i&&i.length>g?(c.matches[j].hasOwnProperty("warningClass")&&(q=c.matches[j].warningClass),p=b.getWrapedText(p,e,a,q)):-1!==p.indexOf(a)&&(c.matches[j].hasOwnProperty("matchClass")&&(q=c.matches[j].matchClass),p=b.getWrapedText(p,e,a,q))}b.$backgroundDiv.html(p+o),b.$element.trigger("textarea.highlighter.update",{textList:e}),b.isInited||(b.isInited=!0,b.$element.trigger("textarea.highlighter.init.complete"))},c.typingDelay);b.$element.data("highlighterTimerId",d)},getWrapedText:function(a,b,c,d){return b.push(c),a.replace(new RegExp(h(c),"g"),this.getTextInSpan(d,c))},getTextInSpan:function(a,b){return'<span class="'+a+'">'+b+"</span>"},checkMaxLength:function(){var a=this,b=a.$element.val(),c=a.settings,d=0,e={overMaxText:"",notOverMaxText:""};if(0<c.maxlength){if(c.maxlength<b.length){var f=b.slice(c.maxlength,c.maxlength+b.length-1);e.overMaxText=a.getTextInSpan(c.maxlengthWarning,f)}null!==c.maxlengthElement&&(d=c.maxlength-b.length,0>d?c.maxlengthElement.hasClass(c.maxlengthWarning)||c.maxlengthElement.addClass(c.maxlengthWarning):c.maxlengthElement.hasClass(c.maxlengthWarning)&&c.maxlengthElement.removeClass(c.maxlengthWarning),c.maxlengthElement.text(d)),e.notOverMaxText=b.slice(0,c.maxlength)}else e.notOverMaxText=b;return e},destroy:function(){a.data(this.element,"plugin_"+e,!1),this.$backgroundDiv.remove(),this.$element.off("scroll.textarea.highlighter").off("input.textarea.highlighter keyup.textarea.highlighter").off("textarea.highlighter.destroy").off("textarea.highlighter.update").off("textarea.highlighter.change").css({color:"",position:"",background:""}).unwrap()},debugModeOn:function(){this.settings.debug=!0,this.$backgroundDiv.css({color:"#f00"}),this.$element.css({color:"rgba(0,0,0,0.5)"})},debugModeOff:function(){this.settings.debug=!1,this.$backgroundDiv.css({color:"transparent"}),this.$element.css({color:"inherit"})}},a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new g(this,b))})};var h=function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},i=function(){var a=navigator.userAgent,b=/(msie|trident)/i.test(a),c=/chrome/i.test(a),d=/firefox/i.test(a),e=/safari/i.test(a)&&!c,f=/iphone/i.test(a);return b?{msie:!0}:c?{chrome:!0}:d?{firefox:!0}:f?{iphone:!0}:e?{safari:!0}:{msie:!1,chrome:!1,firefox:!1,safari:!1,iphone:!1}}()}(jQuery,window,document);